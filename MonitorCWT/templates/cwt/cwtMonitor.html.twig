{% extends 'basenavbar.html.twig' %}

{% block title %}CWT Monitor
{% endblock %}


{% block content %}
	<div class="container-fluid mt-2">
		<div class="row">
			<div class="col-md-3">
				<h6 class="mt-1">Select the Device</h6>
				<div class="spinner-border" role="status" id="spinnerDevices">
					<span class="sr-only">Loading...</span>
				</div>
				<select class="custom-select form-control d-none" id="selectDevices" name="selectDevices">
					<option>Select One</option>
				</select>
					
				<h6 class="mt-2">Select one or more interfaces</h6>
				<div id="listinterfaces">
				<div class="spinner-border d-none" role="status" id="spinnerIn">
					<span class="sr-only">Loading...</span>
				</div>
				</div>
				<div class="form-check mt-1">
				</div>

				{# <h6>Graphic options</h6>
				<div class="form-check mt-1">
					<input class="form-check-input" type="checkbox" value="" id="defaultCheck1">
					<label class="form-check-label" for="defaultCheck1">
						Group
					</label>
				</div> #}
			</div>
			<div class="col-md-9">
				<div class="w-100">
					<canvas id="chartjs-0"></canvas>
				</div>

			</div>
		</div>
	</div>
{% endblock %}
{% block javascripts %}
	<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>
	<script>
	new Chart(document.getElementById("chartjs-0"),{"type":"line","data":{"labels":["January","February","March","April","May","June","July"],"datasets":[{"label":"My First Dataset","data":[65,59,80,81,56,55,40],"fill":false,"borderColor":"rgb(75, 192, 192)","lineTension":0.1}]},"options":{}});
	</script>
	<script>
	$(function() {
		let devices = $.post("{{path('myDevices')}}");
		$.when(devices).done(function(data){
			data.forEach(element => {
				$('#selectDevices').append(new Option(element.deviceId,element.id));
			});
			$('#selectDevices').toggleClass('d-none');
			$('#spinnerDevices').toggleClass('d-none');
		});
		$('#selectDevices').change(()=>{
			$('#spinnerIn').toggleClass('d-none');
			$("#selectDevices option:selected" ).each(function() {
				let inter = $.post("{{path('getMyInterfaces')}}",{"device":this.value});
				$.when(inter).done(data=>{
					data.forEach(e=>{
						$('#listinterfaces').append(
							'<div class="form-check mt-1">'+
								'<input class="form-check-input" type="checkbox" value="'+ e.id +'">'+
								'<label class="form-check-label" for="defaultCheck1">'+
									e.name+' - '+e.type.name+
								'</label>'+
							'</div>'
						);
					});
					$('#spinnerIn').toggleClass('d-none');
				});
			});
		});
	});
	</script>
{% endblock %}
